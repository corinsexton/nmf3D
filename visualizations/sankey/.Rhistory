color = dds2[[color_lab]],
text = colnames(dds2),
type = "scatter",
mode = "markers")
fig
fig %>% layout(xaxis = list(paste0("PC1: ",percentVar[1],"% variance")),
yaxis = paste0("PC2: ",percentVar[2],"% variance"))
list(paste0("PC1: ",percentVar[1],"% variance"))
fig %>% layout(xaxis = list(paste0("PC1: ",percentVar[1],"% variance")),
yaxis = list(paste0("PC2: ",percentVar[2],"% variance")))
fig
fig %>% layout(xaxis = list(paste0("PC1: ",percentVar[1],"% variance")),
yaxis = list(paste0("PC2: ",percentVar[2],"% variance")))
fig <- plot_ly(data = pcaData, x = ~PC1, y = ~PC2,
color = dds2[[color_lab]],
text = colnames(dds2),
type = "scatter",
mode = "markers")
fig <- fig %>% layout(xaxis = list(paste0("PC1: ",percentVar[1],"% variance")),
yaxis = list(paste0("PC2: ",percentVar[2],"% variance")))
fig
fig <- fig %>% layout(xaxis = list(title = paste0("PC1: ",percentVar[1],"% variance")),
yaxis = list(title = paste0("PC2: ",percentVar[2],"% variance")))
fig
runApp('Downloads/mwshiny-examples-master/pop')
att_ss <- attrib[attrib$run %in% colnames(hervh_mat),]
runApp('Downloads/mwshiny-examples-master/pop')
results(dds2)
runApp('Downloads/mwshiny-examples-master/pop')
runApp('Downloads/mwshiny-examples-master/pop')
runApp('Downloads/mwshiny-examples-master/pop')
runApp('Downloads/mwshiny-examples-master/pop')
runApp('Downloads/mwshiny-examples-master/pop')
res <- results(dds2,name = lab)
res <- results(dds2)
# add a grouping column; default value is "not significant"
res["group"] <- "NotSignificant"
# change the grouping for the entries with significance but not a large enough Fold change
res[which(res['padj'] < 0.05 & abs(res['log2FoldChange']) < 1.5 ),
"group"] <- "Significant"
which(res['padj'] < 0.05 & abs(res['log2FoldChange'])
)
which(res['padj'] < 0.05 & abs(res['log2FoldChange']) < 1.5 )
res['padj']
res['padj'] < 0.05 & abs(res['log2FoldChange']) < 1.5
res['log2FoldChange']
abs(res['log2FoldChange']) < 1.5
abs(res['log2FoldChange'])
res['padj'] < 0.05
res['padj']
res['padj']
res['padj'] < 0.05
res <- data.frame(results(dds2))
# add a grouping column; default value is "not significant"
res["group"] <- "NotSignificant"
# change the grouping for the entries with significance but not a large enough Fold change
res[which(res['padj'] < 0.05 & abs(res['log2FoldChange']) < 1.5 ),
"group"] <- "Significant"
# change the grouping for the entries a large enough Fold change but not a low enough p value
res[which(res['padj'] > 0.05 & abs(res['log2FoldChange']) > 1.5 ),
"group"] <- "FoldChange"
# change the grouping for the entries with both significance and large enough fold change
res[which(res['padj'] < 0.05 & abs(res['log2FoldChange']) > 1.5 ),
"group"] <- "Significant&FoldChange"
p <- plot_ly(data = res,
x = ~log2FoldChange,
y = -log10(padj),
mode = "markers",
color = group) %>%
layout(title ="Volcano Plot") %>%
p
p <- plot_ly(data = res,
x = ~log2FoldChange,
y = ~-log10(padj),
mode = "markers",
color = group) %>%
layout(title ="Volcano Plot") %>%
p
p <- plot_ly(data = res,
x = ~log2FoldChange,
y = ~-log10(padj),
mode = "markers",
color = ~group) %>%
layout(title ="Volcano Plot") %>%
p
p <- plot_ly(data = res,
x = ~log2FoldChange,
y = ~-log10(padj),
mode = "markers",
color = ~group) %>%
layout(title ="Volcano Plot")
p
p <- plot_ly(data = res,
x = ~log2FoldChange,
y = ~-log10(padj),
mode = "markers",
color = ~group,
type = 'scatter') %>%
layout(title ="Volcano Plot")
p
View(results)
View(res)
p <- plot_ly(data = res,
x = ~log2FoldChange,
y = ~-log10(padj),
mode = "markers",
color = ~group,
text = rownames(res),
type = 'scatter') %>%
layout(title ="Volcano Plot")
p
runApp('Downloads/mwshiny-examples-master/pop')
runApp('Downloads/mwshiny-examples-master/pop')
runApp('Downloads/mwshiny-examples-master/pop')
ggplot(data = mpg, aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
scale_shape_discrete(labels = c("four wheel drive", "front wheel", "rear wheel"))
library(ggplot2)
ggplot(data = mpg, aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
scale_shape_discrete(labels = c("four wheel drive", "front wheel", "rear wheel"))
ggplot(data = mpg, aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
scale_shape_discrete(labels = c("four wheel drive", "front wheel", "rear wheel")) +
ylim(20,30)
ggplot(data = subset(mpg, class != '2seater'), aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
scale_shape_discrete(labels = c("four wheel drive", "front wheel", "rear wheel")) +
ylim(20,30)
ggplot(data = subset(mpg, class != '2seater'), aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
scale_shape_discrete(labels = c("four wheel drive", "front wheel", "rear wheel")) +
ggplot(data = subset(mpg, class != '2seater'), aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
scale_shape_discrete(labels = c("four wheel drive", "front wheel", "rear wheel")) +
)
ggplot(data = subset(mpg, class != '2seater'), aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
scale_shape_discrete(labels = c("four wheel drive", "front wheel", "rear wheel"))
ggplot(data = subset(mpg, class != '2seater'), aes(x = class, y = hwy))+
geom_boxplot() +
labs(title = "Car Data",
x = "Car Class",
y = "Highway Fuel Economy")
ggplot(data = subset(mpg, class != '2seater'), aes(x = class, y = hwy, fill = drv))+
geom_boxplot() +
labs(title = "Car Data",
x = "Car Class",
y = "Highway Fuel Economy")
ggplot(data = mpg, aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
scale_shape_discrete(labels = c("four wheel drive", "front wheel", "rear wheel"))+
geom_smooth()
ggplot(data = mpg, aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
scale_shape_discrete(labels = c("four wheel drive", "front wheel", "rear wheel"))+
geom_smooth(method = 'lm')
ggplot(data = mpg, aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
scale_shape_discrete(labels = c("four wheel drive", "front wheel", "rear wheel"))+
geom_smooth(aes(colour=NA)method = 'lm')
ggplot(data = mpg, aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
scale_shape_discrete(labels = c("four wheel drive", "front wheel", "rear wheel"))+
geom_smooth(aes(colour=NA), method = 'lm')
ggplot(data = mpg, aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
scale_shape_discrete(labels = c("four wheel drive", "front wheel", "rear wheel"))+
geom_smooth(aes(colour=NA, shape = NA), method = 'lm')
ggplot(data = subset(mpg, class != '2seater'), aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
scale_shape_discrete(labels = c("four wheel drive", "front wheel", "rear wheel")) +
ylim(20,30) +
geom_smooth(hwy~displ+class+drv, aes(colour=NA, shape = NA), method = 'lm')
ggplot(data = subset(mpg, class != '2seater'), aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
scale_shape_discrete(labels = c("four wheel drive", "front wheel", "rear wheel")) +
ylim(20,30) +
geom_smooth(hwy~displ+class+drv, method = 'lm')
?geom_smooth
ggplot(data = subset(mpg, class != '2seater'), aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
scale_shape_discrete(labels = c("four wheel drive", "front wheel", "rear wheel")) +
ylim(20,30) +
geom_smooth(aes(colour=NA, shape = NA), method = 'lm')
ggplot(data = mpg, aes(x = <PICK COL>, y = <PICK COL>)) +
geom_point()
ggplot(data = mpg, aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
scale_shape_discrete(labels = c("four wheel drive", "front wheel", "rear wheel"))
ggplot(data = mpg, aes(x = displ, y = hwy)) +
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy")
ggplot(data = mpg, aes(x = displ, y = hwy)) +
geom_point(color = "blue") +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy")
ggplot(data = mpg, aes(x = displ, y = hwy)) +
geom_point(color = "blue") +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy")
ggplot(data = mpg, aes(x = displ, y = hwy, color = class)) +
geom_point(color = "blue") +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy")
ggplot(data = mpg, aes(x = displ, y = hwy, color = class)) +
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy")
ggplot(data = subset(mpg, class != "2seater"), aes(x = displ, y = hwy, color = class)) +
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy")
ggplot(data = subset(mpg, class != '2seater'), aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
geom_smooth()
ggplot(data = subset(mpg, class != '2seater'), aes(x = displ, y = hwy, color = class, shape = drv))+
geom_point() +
labs(title = "Car Data",
x = "Engine Size",
y = "Highway Fuel Economy",
color = "Class",
shape = "Drive type") +
geom_smooth(aes(colour=NA, shape = NA), method = 'lm')
library(networkD3)
edges <- read.csv("https://raw.githubusercontent.com/kilimba/data/master/infection_flows.csv",stringsAsFactors = FALSE)
nodes = data.frame(ID = unique(c(edges$Source, edges$Target)), stringsAsFactors = FALSE)
edges$Source <- match(edges$Source, nodes$ID) - 1
edges$Target <- match(edges$Target, nodes$ID) - 1
sankeyNetwork(Links = edges, Nodes = nodes,
Source = "Source", Target = "Target",
Value = "Value", NodeID = "ID",
width = 700, fontSize = 12, nodeWidth = 30)
setwd("~/Documents/UNLV/Year4/nmf3D/sankey")
library(tidyverse)
library(UpSetR)
library(networkD3)
net <- read_tsv("network.tsv")
network <- as_tibble(table(net))
colnames(network) <- c("source", "target", "value")
network$source <- as.numeric(network$source)
network$target <- as.numeric(network$target)
network$value <- as.numeric(network$value)
# MUST BE ZERO-INDEXED
network$source <- network$source - 1
network$target <- network$target - 1
nodes = data.frame("name" =
c("a","b","c"),
"node" = 0:2,stringsAsFactors = F
)
names(network) = c("source", "target", "value")
# Plot
sn <- sankeyNetwork(Links = data.frame(network), Nodes = nodes,
Source = "source", Target = "target",
Value = "value", NodeID = "name")
sn
# Plot
sn <- sankeyNetwork(Links = data.frame(network), Nodes = nodes,
Source = "source", Target = "target",
Value = "value", NodeID = "name",fontSize= 14, nodeWidth = 5)
sn
# Plot
sn <- sankeyNetwork(Links = data.frame(network), Nodes = nodes,
Source = "source", Target = "target",
Value = "value", NodeID = "name",fontSize= 14, nodeWidth = 5)
nodes = data.frame("name" =
c("1","2","3"),
"node" = 0:2,stringsAsFactors = F
)
names(network) = c("source", "target", "value")
# Plot
sn <- sankeyNetwork(Links = data.frame(network), Nodes = nodes,
Source = "source", Target = "target",
Value = "value", NodeID = "name",fontSize= 14, nodeWidth = 5)
sn
network$target <- network$target - 1 + 3
net <- read_tsv("network.tsv")
network <- as_tibble(table(net))
colnames(network) <- c("source", "target", "value")
network$source <- as.numeric(network$source)
network$target <- as.numeric(network$target)
network$value <- as.numeric(network$value)
# MUST BE ZERO-INDEXED
network$source <- network$source - 1
network$target <- network$target - 1 + 3
nodes = data.frame("name" =
c("1_h1","2_h1","3_h1","1_endo", "2_endo","3_endo"),
"node" = 0:2,stringsAsFactors = F
)
names(network) = c("source", "target", "value")
# Plot
sn <- sankeyNetwork(Links = data.frame(network), Nodes = nodes,
Source = "source", Target = "target",
Value = "value", NodeID = "name",fontSize= 14, nodeWidth = 5)
sn
library(Matrix)
library(RcppML)
library(tidyverse)
library(pheatmap)
con_mat <- read_tsv("matrix_connections.tsv")
x <- as.matrix(con_mat[,-1])
library(Matrix)
library(RcppML)
library(tidyverse)
# setwd("/home/csexton/compute/NMF_differentiation/RcppML_nmf")
setwd("/Users/coripenrod/Documents/UNLV/Year4/nmf3D/RcppML_nmf")
library(Matrix)
library(RcppML)
library(tidyverse)
library(pheatmap)
con_mat <- read_tsv("matrix_connections.tsv")
x <- as.matrix(con_mat[,-1])
rownames(x) <- con_mat$region
matCSC <- as(x, "dgCMatrix")
num_labels = 6
num_runs = 100
model <- nmf(matCSC, k = num_labels, maxit = num_runs, tol = 1e-100)
# ONLY LOCALLY, NON DEV VERSION OF RcppML
colnames(model$h) <- colnames(matCSC)
rownames(model$h) <- 1:num_labels
png(paste0("h_",num_labels,".png"),width = 1300, height = 1000, res = 200)
pheatmap(t(model$h), scale = "row", border_color = NA, cluster_rows = F,
cluster_cols = T, fontsize = 14,
main = paste0("H matrix k=",num_labels),
breaks = seq(-1, 1, length.out = 100))
# main = "Segmentation of H1 and naive hESCs",
# breaks = seq(-1, 1, length.out = 100)
dev.off()
colnames(model$w) <- 1:num_labels
rownames(model$w) <- rownames(matCSC)
con_mat <- con_mat %>% separate(region,c("chr","type","pos1","pos2"),sep = '[:_-]')
all_labelled <- data.frame(type = con_mat$type, chr = con_mat$chr, pos1 = con_mat$pos1, pos2 = con_mat$pos2,
label = colnames(model$w)[apply(model$w,1,which.max)])
h1_labelled <- subset(all_labelled, type == 'h1')[,2:5]
endo_labelled <- subset(all_labelled, type == 'endo')[,2:5]
write_tsv(h1_labelled, "h1_labelled.bed", col_names = F)
write_tsv(endo_labelled, "endo_labelled.bed", col_names = F)
net <- read_tsv("network.tsv")
network <- as_tibble(table(net))
colnames(network) <- c("source", "target", "value")
network$source <- as.numeric(network$source)
network$target <- as.numeric(network$target)
library(tidyverse)
library(UpSetR)
library(networkD3)
net <- read_tsv("network.tsv")
setwd("~/Documents/UNLV/Year4/nmf3D/sankey")
library(tidyverse)
library(UpSetR)
library(networkD3)
net <- read_tsv("network.tsv")
network <- as_tibble(table(net))
colnames(network) <- c("source", "target", "value")
network$source <- as.numeric(network$source)
network$target <- as.numeric(network$target)
network$value <- as.numeric(network$value)
# MUST BE ZERO-INDEXED
network$source <- network$source - 1
network$target <- network$target - 1 + 3
nodes = data.frame("name" =
c("1_h1","2_h1","3_h1","1_endo", "2_endo","3_endo"),
"node" = 0:2,stringsAsFactors = F
)
names(network) = c("source", "target", "value")
net <- read_tsv("network.tsv")
network <- as_tibble(table(net))
colnames(network) <- c("source", "target", "value")
network$source <- as.numeric(network$source)
network$target <- as.numeric(network$target)
network$value <- as.numeric(network$value)
# MUST BE ZERO-INDEXED
network$source <- network$source - 1
network$target <- network$target - 1 + 6
paste0(1:6,"_h1")
nodes = data.frame("name" =
c(paste0(1:6,"_h1"),
paste0(1:6,"_endo")),
"node" = 0:2,stringsAsFactors = F
)
names(network) = c("source", "target", "value")
# Plot
sn <- sankeyNetwork(Links = data.frame(network), Nodes = nodes,
Source = "source", Target = "target",
Value = "value", NodeID = "name",fontSize= 14, nodeWidth = 5)
sn
# sn <- htmlwidgets::prependContent(sn, htmltools::tags$h1("HERVH Candidate Loci"))
sn <- htmlwidgets::prependContent(sn, htmltools::HTML('<h1 style="font-family:Arial, sans-serif;font-weight:bold;margin-bottom:0;text-align:center">Label Movement</h1><div style="position:relative;padding: 10px 20px 0px 20px;margin-bottom:50px;">
<p style="font-family:Arial, sans-serif;font-weight:bold;position:absolute;left:0;">H1</p>
<p style="font-family:Arial, sans-serif;font-weight:bold;position:absolute;right:0;">Endoderm</p>
</div>'))
# htmlwidgets::sizingPolicy(padding = 10, browser.fill = TRUE)
# sn$sizingPolicy$viewer$fill <- FALSE
sn$sizingPolicy$browser$fill <- F
sn$sizingPolicy$browser$defaultWidth <- 400
sn
# htmlwidgets::sizingPolicy(padding = 10, browser.fill = TRUE)
# sn$sizingPolicy$viewer$fill <- FALSE
sn$sizingPolicy$browser$fill <- F
sn$sizingPolicy$browser$defaultWidth <- 400
sn
# you save it as an html
saveNetwork(sn, "sn_hervh_candidate_loci.html")
# you save it as an html
saveNetwork(sn, "sn_hervh_candidate_loci.html")
library(webshot)
# you convert it as png
webshot("6lab_nmf.html","sn_hervh_candidate_loci.png", vwidth =400, vheight = 1200)
# you convert it as png
webshot("6lab_nmf.html","sn_hervh_candidate_loci.png", vwidth =400, vheight = 1200)
# you convert it as png
webshot("6lab_nmf.html","sn_hervh_candidate_loci.png", vwidth =400, vheight = 800)
# you convert it as png
webshot("sn_hervh_candidate_loci.html","6lab_nmf.png", vwidth =400, vheight = 1200)
# you save it as an html
saveNetwork(sn, "6lab_nmf.html")
library(webshot)
# you convert it as png
webshot("6lab_nmf.html","6lab_nmf.png", vwidth =400, vheight = 800)
# you convert it as png
webshot("6lab_nmf.html","6lab_nmf.png", vwidth =400, vheight = 600)
